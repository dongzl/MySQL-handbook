
ä½œè€…é¦–é¡µé“¾æŽ¥ï¼šhttps://chensj.blog.csdn.net/

åŽŸæ–‡é“¾æŽ¥åœ°å€ï¼šhttps://blog.csdn.net/qq_39390545/article/details/115214802

æˆ‘æœ‰ä¸€ä¸ªè€æœ‹å‹ï¼Œæˆ‘ä»¬å«ä»–ç†ŠçŒ«ã€‚å‘é™…çº¿åŠå°†è§¦ç¢°åˆ°åŽè„‘å‹ºï¼Œå¤§æ¡†é‡‘ä¸çœ¼é•œä¹ŸæŽ©ç›–ä¸ä½é‚£é»é»‘çš„çœ¼åœˆï¼Œæ˜¾å¾—æ ¼å¤–çš„â€œç¨‹åºå‘˜â€ï¼›ç©¿ç€ä¹Ÿéžå¸¸ä¸æ‹˜ä¸€æ ¼ï¼Œä¸ŠåŠèº«æ˜¯è¡¬è¡£è¥¿æœï¼Œä¸‹åŠèº«æ˜¯ç‰›ä»”è£¤é…æ‹–éž‹~

![](https://img-blog.csdnimg.cn/20210325175649415.png)

æˆ‘å’Œç†ŠçŒ«çš„æ„Ÿæƒ…å¾ˆå¥½ï¼Œæ¯•ä¸šåŽä»–åŽ»äº†ä¸Šæµ·è€Œæˆ‘å¼€å§‹åŒ—æ¼‚ï¼Œä½†æ¯æ¬¡è¿‡èŠ‚å›žè€å®¶æˆ‘ä¿©éƒ½ä¼šå’Œæœ‹å‹ä»¬ä¸€èµ·åƒé¥­ï¼Œè¿™æ¬¡å›žå®¶è¿‡å¹´ä¹Ÿä¸ä¾‹å¤–ã€‚è¿™æ¬¡ï¼Œæˆ‘ä»¬æœ‹å‹å‡ ä¸ªåŽ»äº†æž£åº„å‡ºåçš„â€œå¥½å†æ¥åœŸèœé¦†â€ï¼Œç‚¹äº†ç‰¹è‰²çš„æž£åº„è¾£å­é¸¡ï¼Œè¶…å¤§ç›˜é‚£ç§ã€‚

å¯¹äº†ï¼ŒåŽ»å¹´æˆ‘åœ¨å†™[ã€Šå¬æˆ‘è®²å®ŒGETã€POSTåŽŸç†ï¼Œé¢è¯•å®˜ç»™æˆ‘å€’äº†æ¯å¡å¸ƒå¥‡è¯ºã€‹](https://blog.csdn.net/qq_39390545/article/details/105616407)æ–‡ç« æ—¶æˆ‘ä»¬åŽ»çš„é‚£å®¶â€œå°æ¿å‡³é…±éª¨å¤´â€ï¼Œå·²ç»è¢«æˆ‘ä»¬å¹²é»„äº†ï¼Œå“ˆå“ˆå“ˆï¼

è¿™æ¬¡åœ¨é¥­æ¡Œä¸Šï¼Œæˆ‘ä»¬èŠåˆ°äº†ç–«æƒ…æœŸé—´æˆ‘ä»¬å‡ ä¸ªç§¯æžå‚åŠ å„å¤§åŽ‚å…è´¹é¢è¯•çš„ä¸€äº›æœ‰è¶£åœºæ™¯ã€‚ç†ŠçŒ«è¯´åœ¨é¢è¯•ä¸€å®¶æ•°æ®å­˜å‚¨çš„å¤§åŽ‚æ—¶ï¼Œæ·±æŒ–äº†ä¸€ä¸ª `MySQL` é—®é¢˜ï¼Œ`redo log` å’Œ `binlog`ï¼Œå¾ˆæœ‰æ„æ€ã€‚é¢è¯•å®˜ä¹Ÿå¾ˆå®¢æ°”ï¼Œæ€»æœ‰ç§èŽ«åçš„äº²åˆ‡æ„Ÿã€‚è¯´ç€ï¼Œç¿˜èµ·äºŒéƒŽè…¿å–Šé“ï¼šâ€œè€æ¿ï¼Œå†æ¥ä¸€ç®±é’å²›â€ï¼æˆ‘ä»¬å‡ ä¸ªéƒ½çŸ¥é“ï¼Œç†ŠçŒ«åˆè¦å¼€å§‹å›žæ”¾äº†~~

> ä»¥ä¸‹æ˜¯ç†ŠçŒ«å’Œé¢è¯•å®˜é©¬ç»ç†çš„å¯¹è¯ã€‚

![](https://img-blog.csdnimg.cn/20210325181332172.jpg)

**ç†ŠçŒ«**ï¼šé©¬â€¦å°é©¬å“¥å¥½ï¼

**é¢è¯•å®˜**ï¼šé¢â€¦ä½ å¥½ï¼Œå°æŽå•Šï¼Œçœ‹ä½ ç®€åŽ†å†™ç€ç²¾é€šMySQLäº‹åŠ¡ã€æ—¥å¿—åŽŸç†ï¼Œä½ è®¤ä¸ºç²¾é€šåº”è¯¥æ˜¯å•¥æ°´å¹³å‘¢ï¼Ÿ

**ç†ŠçŒ«**ï¼šï¼ˆè€è„¸ä¸€çº¢ï¼‰emmmâ€¦ç²¾é€šå°±æ˜¯ï¼Œæ¯”é¢è¯•å®˜çŸ¥é“çš„å¤šä¸€ç‚¹å‘—ã€‚ã€‚

![](https://img-blog.csdnimg.cn/20210403222204770.gif#pic_center)

**é¢è¯•å®˜**ï¼šï¼ˆå—¯ã€‚ã€‚ã€‚ã€‚æ˜¯ä¸ªè€å®žäººï¼Œæˆ‘å–œæ¬¢ï¼ï¼‰

**é¢è¯•å®˜**ï¼šé‚£ä½ å…ˆç»™æˆ‘è®²è®² `MySQL` é‡Œæœ‰å“ªäº›æ¯”è¾ƒé‡è¦çš„æ—¥å¿—å§ï¼Ÿ

**ç†ŠçŒ«**ï¼šï¼ˆæˆ‘åªçœ‹äº† `redo log`ã€`binlog` é¢è¯•é¢˜ï¼Œå’‹æ•´ï¼Œå¤šè¯´ä¼šä¸ä¼šç»™è‡ªå·±æŒ–å‘ï¼Ÿè®°å¾—é²è¿…å¤§çˆ·è¯´è¿‡ï¼šåˆ«å•¥ `JB` éƒ½è¯´ï¼Œæœ€åŽå‘è‡ªå·±ï¼‰

![](https://img-blog.csdnimg.cn/20201023113827386.png)

**ç†ŠçŒ«**ï¼šå—¯ã€‚ã€‚å…¶å®ž `MySQL` ä¸­çš„æ—¥å¿—æœ‰å¾ˆå¤šï¼Œä½†æ—¥å¸¸æŽ¥è§¦æœ€å¤šçš„æ˜¯é‡åšæ—¥å¿—ï¼ˆ`redo log`ï¼‰ã€å½’æ¡£æ—¥å¿—ï¼ˆ`binlog`ï¼‰è¿™ä¸¤ç§ï¼Œå½“ç„¶è¿˜æœ‰å›žæ»šæ—¥å¿—ï¼ˆ`undo log`ï¼‰ç­‰ç­‰ï¼Œæˆ‘æŽ¥è§¦çš„å°‘ä¸€äº›ã€‚

**MySQLæ—¥å¿—ä¸»è¦åŒ…æ‹¬å…­ç§**ï¼š
- é‡åšæ—¥å¿—ï¼ˆ`redo log`ï¼‰
- å›žæ»šæ—¥å¿—ï¼ˆ`undo log`ï¼‰
- å½’æ¡£æ—¥å¿—ï¼ˆ`binlog`ï¼‰
- é”™è¯¯æ—¥å¿—ï¼ˆ`errorlog`ï¼‰
- æ…¢æŸ¥è¯¢æ—¥å¿—ï¼ˆ`slow query log`ï¼‰
- ä¸€èˆ¬æŸ¥è¯¢æ—¥å¿—ï¼ˆ`general log`ï¼‰
- ä¸­ç»§æ—¥å¿—ï¼ˆ`relay log`ï¼‰

**é¢è¯•å®˜**ï¼šå¥½ï¼Œé‚£ä½ å…ˆè¯´ä¸€ä¸‹ä½ å¯¹ `redo log` æ—¥å¿—çš„ç†è§£å§ã€‚

**ç†ŠçŒ«**ï¼šè®°å¾—å°æ—¶å€™çœ‹ã€Šæ­¦æž—å¤–ä¼ ã€‹ï¼Œå•ç§€æ‰æŸœå°ä¸‹é¢æœ‰ä¸€ä¸ªå°é»‘æ¿ï¼Œå½“æ—¶ä¸çŸ¥é“æ˜¯å¹²å•¥çš„ï¼ŒåŽæ¥å‘çŽ°æ˜¯ä¸“é—¨ç”¨æ¥è®°å½•å®¢äººçš„èµŠè´¦è®°å½•ã€‚å¦‚æžœèµŠè´¦çš„äººä¸å¤šï¼Œé‚£ä¹ˆä»–å¯ä»¥æŠŠé¡¾å®¢åå’Œè´¦ç›®å†™åœ¨æ¿ä¸Šã€‚ä½†å¦‚æžœèµŠè´¦çš„äººå¤šäº†ï¼Œå°é»‘æ¿æ²¡åœ°å„¿äº†ï¼Œè¿™ä¸ªæ—¶ç§€æ‰ä¸€å®šè¿˜æœ‰ä¸€ä¸ªä¸“é—¨è®°å½•èµŠè´¦çš„è´¦æœ¬ã€‚å¦‚æžœæœ‰äººè¦èµŠè´¦æˆ–è€…è¿˜è´¦çš„è¯ï¼Œç§€æ‰ä¸€èˆ¬æœ‰ä¸¤ç§åšæ³•ï¼š

ä¸€ç§åšæ³•æ˜¯ç›´æŽ¥æŠŠè´¦æœ¬ç¿»å‡ºæ¥ï¼ŒæŠŠè¿™æ¬¡èµŠçš„è´¦åŠ ä¸ŠåŽ»æˆ–è€…æ‰£é™¤æŽ‰ï¼›
å¦ä¸€ç§åšæ³•æ˜¯å…ˆåœ¨å°é»‘æ¿ä¸Šè®°ä¸‹è¿™æ¬¡çš„è´¦ï¼Œç­‰æ‰“çƒŠä»¥åŽå†æŠŠè´¦æœ¬ç¿»å‡ºæ¥æ ¸ç®—ã€‚
åœ¨ç”Ÿæ„ç«çˆ†æ—¶ï¼Œç§€æ‰è‚¯å®šä¼šé€‰æ‹©åŽè€…ï¼Œå› ä¸ºç›´æŽ¥è®°è´¦æœ¬å¤ªéº»çƒ¦äº†ã€‚å¾—å…ˆç¿»å‡ºèµŠè´¦äººâ€œè€é’±â€é‚£æ¡è®°å½•ï¼Œè´¦æœ¬å¯†å¯†éº»éº»å‡ åé¡µï¼Œæ‰¾åˆ°åŽå†æ‹¿å‡ºç®—ç›˜è®¡ç®—ï¼Œæœ€åŽæ›´æ–°åˆ°è´¦æœ¬ä¸Šã€‚æƒ³æƒ³éƒ½éº»çƒ¦ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œè¿˜æ˜¯å…ˆåœ¨å°é»‘æ¿ä¸Šè®°ä¸€ä¸‹æ–¹ä¾¿ã€‚ä½ æƒ³æƒ³ï¼Œå¦‚æžœç§€æ‰æ²¡æœ‰å°é»‘æ¿çš„å¸®åŠ©ï¼Œæ¯æ¬¡è®°è´¦éƒ½å¾—ç¿»è´¦æœ¬ï¼Œæ•ˆçŽ‡æ˜¯ä¸æ˜¯ä½Žå¾—è®©äººéš¾ä»¥å¿å—ï¼Ÿè¿˜æœ‰æ—¶é—´æ³¡å°éƒ­ï¼Ÿæƒ³æ— åŒï¼Ÿ

![](https://img-blog.csdnimg.cn/20210325181823644.jpg)

åŒæ ·ï¼Œåœ¨ `MySQL` é‡Œä¹Ÿæœ‰è¿™ä¸ªé—®é¢˜ï¼Œå¦‚æžœæ¯ä¸€æ¬¡çš„æ›´æ–°æ“ä½œéƒ½éœ€è¦å†™è¿›ç£ç›˜ï¼Œç„¶åŽç£ç›˜ä¹Ÿè¦æ‰¾åˆ°å¯¹åº”çš„é‚£æ¡è®°å½•ï¼Œç„¶åŽå†æ›´æ–°ï¼Œæ•´ä¸ªè¿‡ç¨‹ `IO` æˆæœ¬ã€æŸ¥æ‰¾æˆæœ¬éƒ½å¾ˆé«˜ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œ`MySQL` çš„è®¾è®¡è€…å°±ç”¨äº†ç±»ä¼¼ç§€æ‰è®°å°é»‘æ¿çš„æ€è·¯æ¥æå‡æ›´æ–°æ•ˆçŽ‡ã€‚

è€Œå°é»‘æ¿å’Œè´¦æœ¬é…åˆçš„è¿‡ç¨‹ï¼Œå…¶å®žå°±æ˜¯ `MySQL` é‡Œç»å¸¸è¯´åˆ°çš„ `WAL` æŠ€æœ¯ã€‚

**é¢è¯•å®˜**ï¼šå°ä¼™å­ä½ è¿™æ€è·¯å¾ˆå¥‡ç‰¹å‘€ï¼é‚£ä½ å†è¯¦ç»†è·Ÿæˆ‘è¯´ä¸€ä¸‹ï¼Œå•¥æ˜¯ `WAL` æŠ€æœ¯ï¼Ÿ

**ç†ŠçŒ«**ï¼šï¼ˆå°é©¬å“¥å¯¹æˆ‘æœ‰æ„æ€å•Šï¼ï¼‰

> `WAL` çš„å…¨ç§°æ˜¯ `Write-Ahead Logging`ï¼Œå®ƒçš„å…³é”®ç‚¹å°±æ˜¯å…ˆå†™æ—¥å¿—ï¼Œå†å†™ç£ç›˜ï¼Œä¹Ÿå°±æ˜¯å…ˆå†™å°é»‘æ¿ï¼Œç­‰ä¸å¿™çš„æ—¶å€™å†å†™è´¦æœ¬ã€‚

å…·ä½“æ¥è¯´ï¼Œå½“æœ‰ä¸€æ¡ `update` è¯­å¥è¦æ‰§è¡Œçš„æ—¶å€™ï¼Œ`InnoDB` å¼•æ“Žå°±ä¼šå…ˆæŠŠè®°å½•å†™åˆ° `redo log`ï¼ˆå°é»‘æ¿ï¼‰é‡Œé¢ï¼Œå¹¶æ›´æ–°å†…å­˜ï¼Œè¿™ä¸ªæ—¶å€™æ›´æ–°å°±ç®—å®Œæˆäº†ã€‚

åŒæ—¶ï¼Œ`InnoDB` å¼•æ“Žä¼šåœ¨é€‚å½“çš„æ—¶å€™ï¼Œå°†è¿™ä¸ªæ“ä½œè®°å½•æ›´æ–°åˆ°ç£ç›˜é‡Œé¢ï¼Œè€Œè¿™ä¸ªæ›´æ–°å¾€å¾€æ˜¯åœ¨ç³»ç»Ÿæ¯”è¾ƒç©ºé—²çš„æ—¶å€™åšï¼Œè¿™å°±åƒæ‰“çƒŠä»¥åŽç§€æ‰åšçš„äº‹ã€‚å¦‚æžœä»Šå¤©èµŠè´¦çš„ä¸å¤šï¼ŒæŽŒæŸœå¯ä»¥ç­‰æ‰“çƒŠåŽå†æ•´ç†ã€‚ä½†å¦‚æžœæŸå¤©èµŠè´¦çš„ç‰¹åˆ«å¤šï¼Œå°é»‘æ¿å†™æ»¡äº†å’‹åŠžï¼Ÿè¿™ä¸ªæ—¶å€™ç§€æ‰åªå¥½å«æ— åŒå¸®å¿™å¹²è‡ªå·±çš„æ´»å„¿ï¼ŒæŠ“ç´§æŠŠå°é»‘æ¿ä¸­çš„ä¸€éƒ¨åˆ†èµŠè´¦è®°å½•æ›´æ–°åˆ°è´¦æœ¬ä¸­ï¼Œç„¶åŽæŠŠè¿™äº›è®°å½•ä»Žå°é»‘æ¿ä¸Šæ“¦æŽ‰ï¼Œä¸ºè®°æ–°è´¦è…¾å‡ºç©ºé—´ã€‚

ä¸Žæ­¤ç±»ä¼¼ï¼Œ`InnoDB` çš„ `redo log` æ˜¯å›ºå®šå¤§å°çš„ï¼Œæ¯”å¦‚å¯ä»¥é…ç½®ä¸ºä¸€ç»„ `4` ä¸ªæ–‡ä»¶ï¼Œæ¯ä¸ªæ–‡ä»¶çš„å¤§å°æ˜¯ `100MB`ï¼Œé‚£ä¹ˆè¿™å—â€œå°é»‘æ¿â€æ€»å…±å°±å¯ä»¥è®°å½• `400MB` çš„æ“ä½œè®°å½•ã€‚ä»Žå¤´å¼€å§‹å†™ï¼Œå†™åˆ°æœ«å°¾å°±åˆå›žåˆ°å¼€å¤´å¾ªçŽ¯å†™ï¼Œå¦‚ä¸‹é¢è¿™ä¸ªå›¾æ‰€ç¤ºã€‚

![](https://img-blog.csdnimg.cn/20210325175709376.jpg)

`write position` æ˜¯å½“å‰è®°å½•çš„ä½ç½®ï¼Œä¸€è¾¹å†™ä¸€è¾¹åŽç§»ï¼Œå†™åˆ°ç¬¬ `3` å·æ–‡ä»¶æœ«å°¾åŽå°±å›žåˆ° `0` å·æ–‡ä»¶å¼€å¤´ã€‚
`checkpoint` æ˜¯å½“å‰è¦æ“¦é™¤çš„ä½ç½®ï¼Œä¹Ÿæ˜¯å¾€åŽæŽ¨ç§»å¹¶ä¸”å¾ªçŽ¯çš„ï¼Œæ“¦é™¤è®°å½•å‰è¦æŠŠè®°å½•æ›´æ–°åˆ°æ•°æ®æ–‡ä»¶ã€‚
`write position` å’Œ `checkpoint` ä¹‹é—´çš„æ˜¯â€œå°é»‘æ¿â€ä¸Šè¿˜ç©ºç€çš„éƒ¨åˆ†ï¼Œå¯ä»¥ç”¨æ¥è®°å½•æ–°çš„æ“ä½œã€‚

å¦‚æžœ `write pos` è¿½ä¸Š `checkpoint`ï¼Œè¡¨ç¤ºâ€œå°é»‘æ¿â€æ»¡äº†ï¼Œè¿™æ—¶å€™ä¸èƒ½å†æ‰§è¡Œæ–°çš„æ›´æ–°ï¼Œå¾—åœä¸‹æ¥å…ˆæ“¦æŽ‰ä¸€äº›è®°å½•ï¼ŒæŠŠ `checkpoint` æŽ¨è¿›ä¸€ä¸‹ã€‚

æœ‰äº† `redo log`ï¼Œ`InnoDB` å°±å¯ä»¥ä¿è¯å³ä½¿æ•°æ®åº“å‘ç”Ÿå¼‚å¸¸é‡å¯ï¼Œä¹‹å‰æäº¤çš„è®°å½•éƒ½ä¸ä¼šä¸¢å¤±ï¼Œè¿™ä¸ªèƒ½åŠ›ç§°ä¸º `crash-safe`ã€‚

> crash-safeï¼š
å¯ä»¥å¯¹ç…§å‰é¢èµŠè´¦è®°å½•çš„ä¾‹å­ã€‚åªè¦èµŠè´¦è®°å½•è®°åœ¨äº†å°é»‘æ¿ä¸Šæˆ–å†™åœ¨äº†è´¦æœ¬ä¸Šï¼Œå³ä½¿ç§€æ‰çªç„¶è¢«è€é‚¢æŠ“èµ°å‡ å¤©ï¼Œå›žæ¥åŽä¾ç„¶å¯ä»¥é€šè¿‡è´¦æœ¬å’Œå°é»‘æ¿ä¸Šçš„æ•°æ®æ˜Žç¡®èµŠè´¦è´¦ç›®ã€‚å°±æ˜¯ç»´æŠ¤æ•°æ®çš„æŒä¹…æ€§ã€‚
æœ¬è´¨ä¸Šè¯´ï¼Œ`crash-safe` å°±æ˜¯è½ç›˜å¤„ç†ï¼Œå°†æ•°æ®å­˜å‚¨åˆ°äº†ç£ç›˜ä¸Šï¼Œæ–­ç”µé‡å¯ä¹Ÿä¸ä¼šä¸¢å¤±ã€‚

**é¢è¯•å®˜**ï¼šä¸é”™ï¼Œä½ è¿™ç†è§£è™½è¯´å¬çš„æˆ‘ä¸€æ„£ä¸€æ„£ï¼Œä½†æ˜¯è¯ç³™ç†ä¸ç³™ï¼Œç¡®å®žè¯´å‡ºäº† `redo log` çš„åŽŸç†ã€‚é‚£ä½ å†è¯´è¯´å¯¹ `binlog` æ—¥å¿—çš„ç†è§£å§ã€‚

**ç†ŠçŒ«**ï¼š å˜¿å˜¿ï¼Œè°¢è°¢é©¬ç»ç†å¤¸å¥–ã€‚`MySQL` å…¶å®žæ˜¯åˆ†ä¸º `server` å±‚å’Œå¼•æ“Žå±‚ä¸¤éƒ¨åˆ†ã€‚

`Server` å±‚ï¼šå®ƒä¸»è¦åšçš„æ˜¯ MySQL åŠŸèƒ½å±‚é¢çš„äº‹æƒ…ï¼›
å¼•æ“Žå±‚ï¼šè´Ÿè´£å­˜å‚¨ç›¸å…³çš„å…·ä½“äº‹å®œã€‚

ä¸Šé¢æˆ‘ä»¬èŠåˆ°çš„â€œå°é»‘æ¿â€ `redo log` æ˜¯ `InnoDB` å¼•æ“Žç‰¹æœ‰çš„æ—¥å¿—ï¼Œè€Œ `Server` å±‚ä¹Ÿæœ‰è‡ªå·±çš„æ—¥å¿—ï¼Œç§°ä¸º `binlog`ï¼ˆå½’æ¡£æ—¥å¿—ï¼‰ï¼Œå…¶å®žå°±æ˜¯ç”¨æ¥æ¢å¤æ•°æ®ç”¨çš„ã€‚

**é¢è¯•å®˜**ï¼šé‚£ `MySQL` ä¸ºå•¥è¦æœ‰ `redo log` å’Œ `binlog` ä¸¤ä¸ªæ—¥å¿—å‘¢ï¼Ÿåªç•™ä¸€ä¸ªä¸é¦™ä¹ˆï¼Ÿ

**ç†ŠçŒ«**ï¼šå› ä¸ºæœ€å¼€å§‹ `MySQL` é‡Œå¹¶æ²¡æœ‰ `InnoDB` å¼•æ“Žã€‚`MySQL` è‡ªå¸¦çš„å¼•æ“Žæ˜¯ `MyISAM`ï¼Œä½†æ˜¯ `MyISAM` æ²¡æœ‰ `crash-safe` çš„èƒ½åŠ›ï¼Œè€Œ `binlog` æ—¥å¿—åªç”¨äºŽå½’æ¡£ã€‚

`InnoDB` æ˜¯å¦ä¸€ä¸ªå…¬å¸ä»¥æ’ä»¶å½¢å¼å¼•å…¥ `MySQL` çš„ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œåªä¾é  `binlog` æ˜¯æ²¡æœ‰ `crash-safe` èƒ½åŠ›çš„ï¼Œæ‰€ä»¥ `InnoDB` ä½¿ç”¨å¦å¤–ä¸€å¥—æ—¥å¿—ç³»ç»Ÿâ€”â€”ä¹Ÿå°±æ˜¯ `redo log` æ¥å®žçŽ° `crash-safe` èƒ½åŠ›ã€‚

**é¢è¯•å®˜**ï¼šé‚£è¿™ä¸¤ä¸ªæ—¥å¿—ä¸»è¦æœ‰å“ªäº›åŒºåˆ«ï¼Ÿ

**ç†ŠçŒ«**ï¼šemmmâ€¦ä¸»è¦æœ‰å‡ ä¸‹å‡ ç§åŒºåˆ«ï¼š

`redo log` æ˜¯ `InnoDB` å¼•æ“Žç‰¹æœ‰çš„ï¼›`binlog` æ˜¯ `MySQL` çš„ `Server` å±‚å®žçŽ°çš„ï¼Œæ‰€æœ‰å¼•æ“Žå…±ç”¨ã€‚
`redo log` æ˜¯ç‰©ç†æ—¥å¿—ï¼Œè®°å½•çš„æ˜¯â€œåœ¨æŸä¸ªæ•°æ®é¡µä¸Šåšäº†ä»€ä¹ˆä¿®æ”¹â€ï¼›`binlog` æ˜¯é€»è¾‘æ—¥å¿—ï¼Œè®°å½•çš„æ˜¯è¿™ä¸ªè¯­å¥çš„åŽŸå§‹é€»è¾‘ï¼Œæ¯”å¦‚â€œç»™ `ID=1` è¿™ä¸€è¡Œçš„ `c` å­—æ®µåŠ  `1` â€ã€‚
`redo log` æ˜¯å¾ªçŽ¯å†™çš„ï¼Œç©ºé—´å›ºå®šä¼šç”¨å®Œç„¶åŽå¤å†™ï¼›`binlog` æ˜¯å¯ä»¥è¿½åŠ å†™å…¥çš„ã€‚â€œè¿½åŠ å†™â€æ˜¯æŒ‡ `binlog` æ–‡ä»¶å†™åˆ°ä¸€å®šå¤§å°åŽä¼šåˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªï¼Œå¹¶ä¸ä¼šè¦†ç›–ä»¥å‰çš„æ—¥å¿—ã€‚
é¢è¯•å®˜ï¼šå¥½ï¼ŒåŸºäºŽä½ ä¸Šé¢è¯´çš„ï¼Œé‚£æ¯”å¦‚ä¸‹é¢è¿™æ¡ `SQL`ï¼Œä½ æ¥æè¿°ä¸€ä¸‹åœ¨ `MySQL` å†…éƒ¨çš„æ‰§è¡Œæµç¨‹å§

```SQL
update T set money = money + 500 where username = 'é™ˆå“ˆå“ˆ';
```

**ç†ŠçŒ«**ï¼š

ï¼ˆå¼€å§‹ï¼ŒåŽŸå§‹æ•°æ®æŽ¥å…¥ï¼‰æ‰§è¡Œå™¨å…ˆæ‰¾å¼•æ“Žå– username = â€˜é™ˆå“ˆå“ˆâ€™ è¿™ä¸€è¡Œã€‚å¦‚æžœ username = â€˜é™ˆå“ˆå“ˆâ€™ è¿™ä¸€è¡Œæ‰€åœ¨çš„æ•°æ®é¡µæœ¬æ¥å°±åœ¨å†…å­˜ä¸­ï¼Œå°±ç›´æŽ¥è¿”å›žç»™æ‰§è¡Œå™¨ï¼›å¦åˆ™ï¼Œéœ€è¦å…ˆä»Žç£ç›˜è¯»å…¥å†…å­˜ï¼Œç„¶åŽå†è¿”å›žã€‚
ï¼ˆæ•°æ®ä¿®æ”¹ï¼‰æ‰§è¡Œå™¨æ‹¿åˆ°å¼•æ“Žç»™çš„è¡Œæ•°æ®ï¼ŒæŠŠ money è¿™å­—æ®µçš„å€¼åŠ ä¸Š 500ï¼Œæ¯”å¦‚åŽŸæ¥æ˜¯ Nï¼ŒçŽ°åœ¨å°±æ˜¯ N+500ï¼Œå¾—åˆ°æ–°çš„ä¸€è¡Œæ•°æ®ï¼Œå†è°ƒç”¨å¼•æ“ŽæŽ¥å£å†™å…¥è¿™è¡Œæ–°æ•°æ®ã€‚
ï¼ˆæ•°æ®æäº¤ï¼‰æäº¤æ“ä½œï¼Œç”±äºŽå­˜å‚¨å¼•æ“Žå±‚ä¸Žserverå±‚ä¹‹é—´é‡‡ç”¨çš„æ˜¯å†…éƒ¨XA(ä¿è¯ä¸¤ä¸ªäº‹åŠ¡çš„ä¸€è‡´æ€§,è¿™é‡Œä¸»è¦ä¿è¯redo logå’Œbinlogçš„åŽŸå­æ€§)ï¼Œæ‰€ä»¥æäº¤åˆ†ä¸ºprepareé˜¶æ®µä¸Žcommité˜¶æ®µï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è¯´çš„ä¸¤é˜¶æ®µæäº¤ã€‚
ï¼ˆå†™redo logï¼‰å¼•æ“Žå°†è¿™è¡Œæ–°æ•°æ®æ›´æ–°åˆ°å†…å­˜ä¸­ï¼ŒåŒæ—¶å°†è¿™ä¸ªæ›´æ–°æ“ä½œè®°å½•åˆ° redo log é‡Œé¢ï¼ˆå†™åˆ°å†…å­˜æˆ–ç›´æŽ¥è½ç›˜ï¼‰ï¼Œåˆ°è¿™é‡Œï¼Œ redo log å¤„äºŽ prepare çŠ¶æ€ã€‚
ï¼ˆå†™binlogï¼‰ç„¶åŽå‘ŠçŸ¥æ‰§è¡Œå™¨æ‰§è¡Œå®Œæˆäº†ï¼Œéšæ—¶å¯ä»¥æäº¤äº‹åŠ¡ã€‚æ‰§è¡Œå™¨ç”Ÿæˆè¿™ä¸ªæ“ä½œçš„ binlogï¼Œå¹¶æŠŠ binlog åŒæ­¥åˆ°ç£ç›˜ã€‚
ï¼ˆæ•°æ®æ›´æ–°åˆ°ç£ç›˜æˆ–å†…å­˜ï¼Œç»“æŸï¼‰æ‰§è¡Œå™¨è°ƒç”¨å¼•æ“Žçš„æäº¤äº‹åŠ¡æŽ¥å£æ‰§è¡Œä¿®æ”¹æ“ä½œï¼Œéœ€è¦å°†åœ¨äºŒçº§ç´¢å¼•ä¸Šåšçš„ä¿®æ”¹ï¼Œå†™å…¥åˆ°change buffer pageï¼Œç­‰åˆ°ä¸‹æ¬¡æœ‰å…¶ä»–sqléœ€è¦è¯»å–è¯¥äºŒçº§ç´¢å¼•æ—¶ï¼Œå†åŽ»ä¸ŽäºŒçº§ç´¢å¼•åšmergeï¼Œå¼•æ“ŽæŠŠåˆšåˆšå†™å…¥çš„ redo log æ ‡è®°ä¸Šï¼ˆcommitï¼‰çŠ¶æ€ï¼Œå®žé™…ä¸Šæ˜¯åŠ ä¸Šäº†ä¸€ä¸ªä¸Žbinlogå¯¹åº”çš„XIDï¼Œä½¿ä¸¤ä¸ªæ—¥å¿—é€»è¾‘ä¿æŒä¸€è‡´ï¼Œåˆ°æ­¤ç»“æŸï¼Œæ›´æ–°æµç¨‹é—­çŽ¯ã€‚

![](https://img-blog.csdnimg.cn/20210405211853775.png)

**é¢è¯•å®˜**ï¼šé‚£ä¸ºå•¥å¿…é¡»è¦åˆ†æˆ `prepare` å’Œ `commit` ä¸¤ä¸ªé˜¶æ®µè¿›è¡Œæäº¤å‘¢ï¼Ÿä¸€å—å„¿æäº¤ä»–ä¸çˆ½ä¹ˆã€‚

**ç†ŠçŒ«**ï¼šæˆ‘ä¸¾ä¸ªçŽ°å®žç”Ÿæ´»ä¸­çš„æ —å­å§ï¼Œä¸€ä¸ªå®Œæ•´çš„äº¤æ˜“è¿‡ç¨‹æˆ‘è®¤ä¸ºåº”è¯¥è¿™æ ·ï¼š

æ¯”å¦‚ä½ æ¥æˆ‘çš„å°è¶…å¸‚é‡Œä¹°ä¸€ç“¶å¯ä¹ï¼š

**å°é©¬å“¥**ï¼šè€æ¿ç»™æˆ‘æ¥ç“¶å¯ä¹ï¼é€å¿ƒå‡‰å¿ƒé£žæ‰¬çš„é‚£ä¸ªã€‚
**æˆ‘**ï¼šï¼Ÿï¼Ÿ
æœºå™¨æ‰«ä¸€ä¸‹å¯ä¹ï¼Œå‘Šè¯‰å°é©¬å“¥è¿™ç“¶å¯ä¹2å—5ï¼Œä¸èƒ½ç™½å«–ï¼Œè®©ä»–ç»™é’±ï¼ˆè®°å½• `redo log`ï¼Œäº‹åŠ¡å¤„äºŽ `prepare` çŠ¶æ€ï¼‰
æ”¶é’±æ”¾å…¥é’±ç®±ï¼ˆè®°å½• `binlog`ï¼Œäº‹åŠ¡å®žé™…æ˜¯å¦å®Œæˆçš„æ ¹æœ¬ä¾æ®ï¼Œå¤„äºŽå¾…æ ‡è®° `commit` é˜¶æ®µï¼‰
ç„¶åŽè®©ä½ æŠŠå¯ä¹æ‹¿èµ°ï¼ˆ`redo log` çŠ¶æ€æ ‡ä¸º `commit`ï¼Œè¡¨ç¤ºè¯¥äº‹åŠ¡é€»è¾‘é—­çŽ¯ï¼‰ã€‚åˆ°è¿™é‡Œï¼Œä»£è¡¨ä¸€ç¬”äº¤æ˜“ç»“æŸã€‚
å¹¶å‘Šè¯‰å°é©¬å“¥ï¼Œé€å¿ƒå‡‰å¿ƒé£žæ‰¬é‚£ä¸ªæ˜¯é›ªç¢§ï¼Œä½ ä¸ªæ†¨X~
ç­‰ç®—è´¦å‰å†æŠŠè¿™ä¸€å¤©å–ä¸œè¥¿çš„äº¤æ˜“ä¿¡æ¯ä¸€èµ·åŒæ­¥åˆ°æ•°æ®åº“ã€‚
å¯è§ï¼Œå¦‚æžœæ”¶é’±ä¹‹å‰ï¼ˆ`prepare` é˜¶æ®µï¼Œæ­¥éª¤3ï¼‰äº¤æ˜“è¢«æ‰“æ–­ï¼Œå›žè¿‡å¤´æ¥å¤„ç†æ­¤æ¬¡äº¤æ˜“ï¼Œå‘çŽ°åªæœ‰è®°äº†å°é»‘æ¿ä½†æ²¡æœ‰æ”¶é’±ï¼Œåˆ™äº¤æ˜“å¤±è´¥ï¼Œåˆ æŽ‰å°é»‘æ¿ä¸Šçš„è®°å½•ï¼ˆå›žæ»šï¼‰ï¼›

å¦‚æžœæ”¶äº†é’±åŽï¼ˆ`commit` é˜¶æ®µæˆ–å¾… `commit` é˜¶æ®µï¼Œæ­¥éª¤4 || 5ï¼‰äº¤æ˜“è¢«æ‰“æ–­ï¼Œç„¶åŽå›žè¿‡å¤´å‘çŽ°ç³»ç»Ÿä¸Šæœ‰è®°å½•ï¼ˆ`prepare`ï¼‰è€Œä¸”é’±ç®±æœ‰æœ¬æ¬¡æ”¶å…¥ï¼ˆ`binlog`ï¼‰ï¼Œåˆ™è¯´æ˜Žæœ¬æ¬¡äº¤æ˜“æœ‰æ•ˆï¼Œè¡¥å……ä¿®æ”¹ `commit` çŠ¶æ€ï¼Œæ›´æ–°åˆ°åº“å­˜ä¸­ã€‚

ä»¥ä¸Šæ˜¯äººè¯ï¼Œå’±ä»¬å†æ¥çœ‹çœ‹ `MySQL` å±‚é¢çš„ä¸“ä¸šè§£é‡Šï¼š

è¿™é‡Œæˆ‘ä»¬ç”¨åè¯æ³•æ¥è¿›è¡Œè§£é‡Šä¸ºä½•éœ€è¦ä¸¤é˜¶æ®µæäº¤ã€‚ç”±äºŽ `redo log` å’Œ `binlog` æ˜¯ä¸¤ä¸ªç‹¬ç«‹çš„é€»è¾‘ï¼Œå¦‚æžœä¸ç”¨ä¸¤é˜¶æ®µæäº¤ï¼Œè¦ä¹ˆå°±æ˜¯å…ˆå†™å®Œ `redo log` å†å†™  `binlog`ï¼Œæˆ–è€…é‡‡ç”¨åè¿‡æ¥çš„é¡ºåºã€‚æˆ‘ä»¬çœ‹çœ‹è¿™ä¸¤ç§æ–¹å¼ä¼šæœ‰ä»€ä¹ˆé—®é¢˜ã€‚

ä»ç„¶ç”¨å‰é¢çš„ `update` è¯­å¥æ¥åšä¾‹å­ã€‚å‡è®¾å½“å‰ username = â€˜é™ˆå“ˆå“ˆâ€™ çš„è¡Œï¼Œè´¦æˆ·ä½™é¢å­—æ®µ money çš„å€¼æ˜¯ 100ï¼Œå†å‡è®¾æ‰§è¡Œ `update` è¯­å¥è¿‡ç¨‹ä¸­åœ¨å†™å®Œç¬¬ä¸€ä¸ªæ—¥å¿—åŽï¼Œç¬¬äºŒä¸ªæ—¥å¿—è¿˜æ²¡æœ‰å†™å®ŒæœŸé—´å‘ç”Ÿäº† `crash`ï¼ˆå¼‚å¸¸å®•æœºï¼‰ï¼Œä¼šå‡ºçŽ°ä»€ä¹ˆæƒ…å†µå‘¢ï¼Ÿ

ä¾æ—§ä»¥è¿™æ¡SQLä¸ºä¾‹ï¼š

```SQL
update T set money = 0 + 500 where username = 'é™ˆå“ˆå“ˆ';
```

1ã€å…ˆå†™ `redo log` åŽå†™ `binlog`ã€‚
å‡è®¾åœ¨ `redo log` å†™å®Œï¼Œ`binlog` è¿˜æ²¡æœ‰å†™å®Œçš„æ—¶å€™ï¼Œ`MySQL` è¿›ç¨‹å¼‚å¸¸é‡å¯ã€‚ç”±äºŽæˆ‘ä»¬å‰é¢è¯´è¿‡çš„ï¼Œ`redo log` å†™å®Œä¹‹åŽï¼Œç³»ç»Ÿå³ä½¿å´©æºƒï¼Œä»ç„¶èƒ½å¤ŸæŠŠæ•°æ®æ¢å¤å›žæ¥ï¼Œæ‰€ä»¥æ¢å¤åŽè¿™ä¸€è¡Œ money çš„å€¼æ˜¯ money + 500ã€‚
ä½†æ˜¯ç”±äºŽ `binlog` æ²¡å†™å®Œå°± `crash` äº†ï¼Œè¿™æ—¶å€™ `binlog` é‡Œé¢å°±æ²¡æœ‰è®°å½•è¿™ä¸ªè¯­å¥ã€‚å› æ­¤ï¼Œä¹‹åŽå¤‡ä»½æ—¥å¿—çš„æ—¶å€™ï¼Œå­˜èµ·æ¥çš„ `binlog` é‡Œé¢å°±æ²¡æœ‰è¿™æ¡è¯­å¥ã€‚
ç„¶åŽä½ ä¼šå‘çŽ°ï¼Œå¦‚æžœéœ€è¦ç”¨è¿™ä¸ª `binlog` æ¥æ¢å¤ä¸´æ—¶åº“çš„è¯ï¼Œç”±äºŽè¿™ä¸ªè¯­å¥çš„ `binlog` ä¸¢å¤±ï¼Œè¿™ä¸ªä¸´æ—¶åº“å°±ä¼šå°‘äº†è¿™ä¸€æ¬¡æ›´æ–°ï¼Œæ¢å¤å‡ºæ¥çš„è¿™ä¸€è¡Œ money çš„å€¼å°±æ˜¯ 0ï¼Œä¸ŽåŽŸåº“çš„å€¼ä¸åŒã€‚

2ã€å…ˆå†™ `binlog` åŽå†™ `redo log`ã€‚
å¦‚æžœåœ¨ `binlog` å†™å®Œä¹‹åŽ `crash`ï¼Œç”±äºŽ `redo log` è¿˜æ²¡å†™ï¼Œå´©æºƒæ¢å¤ä»¥åŽè¿™ä¸ªäº‹åŠ¡æ— æ•ˆï¼Œç”¨æˆ·ä½™é¢ money çš„å€¼åº”å½“æ˜¯ `0`ã€‚ä½†æ˜¯ `binlog` é‡Œé¢å·²ç»è®°å½•äº†â€œæŠŠ money ä»Ž 0 æ”¹æˆ 500 è¿™ä¸ªæ—¥å¿—ã€‚æ‰€ä»¥ï¼Œåœ¨ä¹‹åŽç”¨ `binlog` æ¥æ¢å¤çš„æ—¶å€™å°±å¤šäº†ä¸€ä¸ªäº‹åŠ¡å‡ºæ¥ï¼Œæ¢å¤å‡ºæ¥çš„è¿™ä¸€è¡Œ money çš„å€¼å°±æ˜¯ 500ï¼Œä¸ŽåŽŸåº“çš„å€¼ä¸åŒã€‚

å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æžœä¸ä½¿ç”¨â€œä¸¤é˜¶æ®µæäº¤â€ï¼Œé‚£ä¹ˆæ•°æ®åº“çš„çŠ¶æ€å°±æœ‰å¯èƒ½å’Œç”¨å®ƒçš„æ—¥å¿—æ¢å¤å‡ºæ¥çš„åº“çš„çŠ¶æ€ä¸ä¸€è‡´ã€‚

ç®€å•è¯´ï¼Œ`redo log` å’Œ `binlog` éƒ½å¯ä»¥ç”¨äºŽè¡¨ç¤ºäº‹åŠ¡çš„æäº¤çŠ¶æ€ï¼Œè€Œä¸¤é˜¶æ®µæäº¤å°±æ˜¯è®©è¿™ä¸¤ä¸ªçŠ¶æ€ä¿æŒé€»è¾‘ä¸Šçš„ä¸€è‡´ã€‚

æ—¥å¿—è½ç›˜
ä¿è¯äº‹åŠ¡æˆåŠŸï¼Œæ—¥å¿—å¿…é¡»è½ç›˜ï¼Œè¿™æ ·ï¼Œæ•°æ®åº“ `crash` åŽï¼Œå°±ä¸ä¼šä¸¢å¤±æŸä¸ªäº‹åŠ¡çš„æ•°æ®äº†

`innodb_flush_log_at_trx_commit` è¿™ä¸ªå‚æ•°è®¾ç½®æˆ 1 çš„æ—¶å€™ï¼Œè¡¨ç¤ºæ¯æ¬¡äº‹åŠ¡çš„ `redo log` éƒ½ç›´æŽ¥æŒä¹…åŒ–åˆ°ç£ç›˜ã€‚è¿™æ ·å¯ä»¥ä¿è¯ `MySQL` å¼‚å¸¸é‡å¯ä¹‹åŽæ•°æ®ä¸ä¸¢å¤±ã€‚

`sync_binlog` è¿™ä¸ªå‚æ•°è®¾ç½®æˆ `1` çš„æ—¶å€™ï¼Œè¡¨ç¤ºæ¯æ¬¡äº‹åŠ¡çš„ `binlog` éƒ½æŒä¹…åŒ–åˆ°ç£ç›˜ã€‚è¿™æ ·å¯ä»¥ä¿è¯ `MySQL` å¼‚å¸¸é‡å¯ä¹‹åŽ `binlog` ä¸ä¸¢å¤±ã€‚

**é¢è¯•å®˜**ï¼šï¼ˆè€è„¸ä¸€çº¢ï¼‰

![](https://img-blog.csdnimg.cn/20210404002318322.png)

**é¢è¯•å®˜**ï¼šå°æŽï¼Œå¦ç™½è¯´æˆ‘ä¹Ÿå¾ˆä¹…æ²¡æžæŠ€æœ¯äº†ï¼Œä½†æˆ‘è§‰å¾—ä½ ç¡®å®žå¾ˆæ‡‚è¿™å—å„¿ï¼Œä¸ºä»€ä¹ˆï¼Ÿå› ä¸ºä½ æŠŠæˆ‘éƒ½ç»™æˆ‘å¹²å›°äº†ã€‚ã€‚æˆ‘å¾ˆæ¬£èµä½ å¹â€¦è®²æ•…äº‹çš„èƒ½åŠ›ï¼Œä½ ï¼Œä½ æ‡‚æˆ‘æ„æ€å§ã€‚

**é¢è¯•å®˜**ï¼šå°æŽå•Šï¼Œä½ ç­‰æˆ‘ä¸€ä¼šå„¿ã€‚ï¼ˆé©¬ç»ç†æç€è£¤å­èµ°å‡ºäº†åŠžå…¬å®¤ï¼‰

**ç†ŠçŒ«**ï¼šï¼ˆå°¿éäº†ï¼Ÿï¼Ÿä¸åº”è¯¥å•Šï¼Œæˆ‘è¿™æ³¢æ“ä½œéš¾é“è¿˜ä¸é¦™ä¹ˆï¼Ÿéš¾é“ï¼Œä»–ä¹Ÿçœ‹äº†é™ˆå“ˆå“ˆçš„åšå®¢ï¼Œè¢«è¯†ç ´äº†ï¼Ÿï¼Ÿ -_-â€™â€™|ï¼‰


äº”åˆ†é’ŸåŽHRæ¥äº†ã€‚ã€‚


**HR**ï¼šå°æŽï¼Œæˆ‘å°±è¯´ä½ è¡Œå§ï¼ï¼é¢†å¯¼å¾ˆçœ‹å¥½ä½ ï¼Œè¯´ä½ è¡¨è¾¾æ€è·¯å¥‡ç‰¹ï¼Œå¾ˆç¬¦åˆè¿™ä¸ªå²—ä½ï¼Œå¹¶ç»™ä½ ç‚¹äº†ä¸ªèµžï¼Œè®©æˆ‘é€šçŸ¥ä½ ä¸‹å‘¨æ¥å…¥èŒå§ã€‚

**ç†ŠçŒ«**ï¼šå¥½çš„å¥½çš„ï¼Œçœ‹æ¥çŽ°åœ¨å¼€å‘å¯¹è¡¨è¾¾èƒ½åŠ›è¦æ±‚è¿˜æŒºé«˜å•Š~~

**HR**ï¼šï¼Ÿï¼Ÿå…„å¼Ÿä¸æ˜¯åº”è˜äº§å“ä¹ˆï¼Ÿ

**ç†ŠçŒ«**ï¼šðŸ˜€ðŸ˜€ðŸ™ƒðŸ™ƒä½ è·Ÿæˆ‘ä¿©æè¿™å„¿æ‰¯çŠŠå­å‘¢ï¼Ÿæˆ‘åº”è˜çš„è½¯ä»¶å¼€å‘å·¥ç¨‹å¸ˆå¤§å“¥ï¼Ÿ

**HR**ï¼šï¼ˆå—¯ï¼Œçœ‹æ¥æžœç„¶æ˜¯æˆ‘æ‰“é”™é¢è¯•ç”µè¯äº†ã€‚ã€‚å†·é™å†·é™ï¼Œå°é—®é¢˜ï¼‰

**HR**ï¼šå¥½çš„ï¼Œé‚£ä»Šå¤©å°±å…ˆè¿™æ ·ï¼Œå›žåŽ»ç­‰é€šçŸ¥å§ðŸ˜ºðŸ˜º è¿˜æœ‰å•¥é—®é¢˜è¦é—®æˆ‘ä¹ˆï¼Ÿ

**ç†ŠçŒ«**ï¼šã€‚ã€‚ã€‚ã€‚ã€‚

![](https://img-blog.csdnimg.cn/20210404005801653.png)

æ€»ç»“
å¥½äº†ï¼Œä»Šå¤©å’±ä»¬äº†è§£äº† `MySQL` é‡Œé¢æœ€é‡è¦çš„ä¸¤ä¸ªæ—¥å¿—ï¼Œå³ç‰©ç†æ—¥å¿— `redo log` å’Œé€»è¾‘æ—¥å¿— `binlog`ã€‚ä¸ºè¯¥è®²çš„å†…å®¹æ€»ç»“äº†å‡ ä¸ªé—®é¢˜, å¤§å®¶å¤ä¹ çš„æ—¶å€™å¯ä»¥å…ˆå°è¯•å›žç­”è¿™äº›é—®é¢˜æ£€æŸ¥è‡ªå·±çš„æŽŒæ¡ç¨‹åº¦ã€‚

`redo log` çš„æ¦‚å¿µæ˜¯ä»€ä¹ˆ? ä¸ºä»€ä¹ˆä¼šå­˜åœ¨.
ä»€ä¹ˆæ˜¯ `WAL(write-ahead log)` æœºåˆ¶, å¥½å¤„æ˜¯ä»€ä¹ˆ.
`redo log` ä¸ºä»€ä¹ˆå¯ä»¥ä¿è¯ `crash safe` æœºåˆ¶.
`binlog` çš„æ¦‚å¿µæ˜¯ä»€ä¹ˆ, èµ·åˆ°ä»€ä¹ˆä½œç”¨, å¯ä»¥åš `crash safe` å—?
`binlog` å’Œ `redolog` çš„ä¸åŒç‚¹æœ‰å“ªäº›?
ç‰©ç†ä¸€è‡´æ€§å’Œé€»è¾‘ä¸€è‡´æ€§å„åº”è¯¥æ€Žä¹ˆç†è§£?
æ‰§è¡Œå™¨å’Œ `InnoDB` åœ¨æ‰§è¡Œ `update` è¯­å¥æ—¶å€™çš„æµç¨‹æ˜¯ä»€ä¹ˆæ ·çš„?
å¦‚æžœæ•°æ®åº“è¯¯æ“ä½œ, å¦‚ä½•æ‰§è¡Œæ•°æ®æ¢å¤?
ä»€ä¹ˆæ˜¯ä¸¤é˜¶æ®µæäº¤, ä¸ºä»€ä¹ˆéœ€è¦ä¸¤é˜¶æ®µæäº¤, ä¸¤é˜¶æ®µæäº¤æ€Žä¹ˆä¿è¯æ•°æ®åº“ä¸­ä¸¤ä»½æ—¥å¿—é—´çš„é€»è¾‘ä¸€è‡´æ€§(ä»€ä¹ˆå«é€»è¾‘ä¸€è‡´æ€§)?
å¦‚æžœä¸æ˜¯ä¸¤é˜¶æ®µæäº¤, å…ˆå†™ `redo log` å’Œå…ˆå†™ `bin log` ä¸¤ç§æƒ…å†µå„ä¼šé‡åˆ°ä»€ä¹ˆé—®é¢˜?

é™„ã€ä¸€å¼ æœ‰æ•…äº‹çš„ç…§ç‰‡ï¼ˆåå…«ï¼‰

![](https://img-blog.csdnimg.cn/20210405213151222.png)

> æ€¥è¯Šå®¤å¤–

> å¦»å­è·ªåœ°ä¸ºä¸ˆå¤«ç¥ˆç¥·

> ç¥žå‘ï¼Œå¦‚æžœæ‚¨èƒ½å¬åˆ°ï¼Œè¯·ä¿ä½‘æˆ‘ä¸ˆå¤«å¹³å®‰ï¼

> åŒ»é™¢çš„å¢™å£æ¯”æ•™å ‚å¬è¿‡æ›´å¤šè™”è¯šçš„ç¥ˆç¥·

> ç«è½¦çš„ç«™å°æ¯”å©šç¤¼è§è¯è¿‡æ›´å¤šçœŸæŒšçš„æ‹¥å»

> å…±å‹‰